---
layout: post
title: NextJS + NOTION + VERCEL
subtitle: Each post also has a subtitle
categories: notion
tags: [website]
top: 1
---

## 关于本篇
在这里我简单介绍一下NotionNext项目的运行原理，以及Notion、Vercel、NotionNext三者的关系。

## 关于解决方案
传统的网站建设，可能会用到的方案：
首先：租一台云服务器；
其次：将网站的代码，例如WordPress或自研的网页上传到到服务器中；
然后：在服务器中自行部署一个数据库，或者向云服务商购买一个数据库。
接着：以服务器为核心，运行代码，并从数据库中读取网页数据。
最后：购买一个域名，将域名绑定在这台服务器的ip地址上。

## 对比
NotionNext的站点本质也是一样的，只是做了元件的替换，即：把服务器、代码、数据库换了别的替代方案。
首先：注册了一个Vercel云平台：主要提供CPU算力、内存空间、操作系统以及运行环境。
其次：注册了一个Github平台：主要提供协同开发、代码存储与版本管理。NotionNext的代码就可以托管在平台进行维护。
然后：注册了一个Notion笔记：将文字、图片等内容存储在笔记中，
接着：以Vercel为核心，从Github中拉取最新版本的代码、编译运行、并从Notion中读取网页数据，按照NotionNext编码的规则展示网页。
最后：将购买的域名，解析到Vercel云平台提供给我们的服务器地址，Vercel负责将域名进一步解析到项目上。
 
## 小结
这里我们可以看到，Vercel替代了服务器的概念，Notion充当一个数据库、NotionNext则是核心的代码。
按我的个人习惯来说，之所以选用这种替代方案，取决于三个痛点：
写作：用Notion写笔记的方式来写文章更加舒适而且长远可持续。用公众号编辑、WordPress后台、用第三方博客平台发布页来写文章，要养成习惯太难。用自己的笔记本写东西才能让我不费力，或者用着舒服，这样才有可能做的长久，做的长久，才有可能做得好。
维护：服务器的安全、升级，数据库的备份、维护，需要耗费一些精力；更可怕的是这种折腾服务器的成就感会让人上瘾，你会不断地从搭建服务器、搭建网站的过程中获得”甜头“，从而沉迷于折腾软件技术。
费用：服务器、域名、我只想发布博客文字，有必要那么贵租一年的服务器吗？

## 工作流程
接下来，看看这个项目的首次安装、运行，与更新、升级配置过程中，发生了哪些事？
 
## 首次安装
《Vercel部署NotionNext》这篇教程详细介绍了部署的方法；部署的过程发生了什么呢？
 
用户首先要复制我的Notion数据库作为模板
Notion充当数据库的角色，所有支持的表头和字段，都已经在NotionNext代码中固定了，如果表头字段不一致，将导致数据无法被正常读取。
用户复制模板的这一过程就相当于在Notion创建了一个属于自己的、NotionNext能识别的数据库。
用户注册Github平台，并且复制一份NotionNext代码
代码是核心，但是如何做到所有用户都能公开拉取到代码，并且还能随时更新代码，甚至一起参与到代码的开发呢？
Github就是一个程序员们最爱的代码协同管理平台，他就类似于腾讯云文档这样的软件，大家都可以参与一个文档的在线编辑，还可以有版本管理的功能，可以记录并回退到任意一个版本中。
注册一个Vercel平台
前面已经解决了代码和数据库的问题，最后就是解决服务器的问题。
登陆Vercel后，你可以选择将代码上传到Vercel平台中进行部署。但Vercel支持一个更强大的功能，就是直接与你的Github仓库建立实时链接。
Vercel将24小时监听你的Github仓库代码，一旦发生更新或改动，它会自行到您的仓库中拉取最新代码，进行打包编译。
从而实现：你无需关注服务器与部署，只要管好自己在Github中的代码即可。打个比方，这时候你是公司的开发人员，只负责代码规则；服务器的运维任务则交给了一个24小时在线的团队管理。
在新版本的NotionNext，绝大部分的代码配置都支持直接在Notion中配置，这样可以实现，你无需关心代码，只要专注在Notion中配置站点，维护文章内容即可。

## NotionNext的运作过程
Vercel 云计算运行 NotionNext代码，不断从你的Notion数据库拉取文章，排版成网站。Notion数据发生变化后，网站数据也会跟着改变。若用纯技术的语言来描述可能比较晦涩难懂，我接下来用打比喻的方式来介绍这个项目的工作原理。